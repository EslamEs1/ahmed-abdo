{% extends 'website/base.html' %}
{% load static %}
{% load product_tags %}
{% block content %}
      <!-- Hero Banner -->
      <section class="category-hero women-hero">
        <div class="container">
          <div class="row">
            <div class="col-md-7">
              <div class="hero-content">
                <span class="hero-subtitle">تشكيلة النساء</span>
                <h1 class="hero-title mb-4">أزياء تعكس جمالك</h1>
                <p class="hero-text mb-4">اكتشفي مجموعتنا المميزة من الأزياء النسائية العصرية. تشكيلة متنوعة من الفساتين والبلوزات والحقائب والإكسسوارات المصممة لتناسب ذوقك وأسلوبك.</p>
                <div class="hero-features mb-4">
                  <div class="hero-feature">
                    <i class="bi bi-gem"></i>
                    <span>تصاميم حصرية</span>
                  </div>
                  <div class="hero-feature">
                    <i class="bi bi-heart"></i>
                    <span>خامات فاخرة</span>
                  </div>
                  <div class="hero-feature">
                    <i class="bi bi-truck"></i>
                    <span>توصيل سريع</span>
                  </div>
                </div>
                <div class="hero-buttons">
                  <a href="#new-arrivals" class="btn btn-primary btn-lg me-2">تسوقي الآن</a>
                  <a href="#collections" class="btn btn-outline-light btn-lg">المجموعات</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Category Filters -->
      <section class="category-filters py-4" id="new-arrivals">
        <div class="container">
          <div class="row">
            <div class="product-filter mb-4">
              <ul class="nav nav-pills category-nav justify-content-center" id="categoryTabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active" id="all-tab" data-bs-toggle="pill" data-bs-target="#all" type="button" role="tab" aria-controls="all" aria-selected="true">الكل</button>
                </li>
                {% for subcategory in category.children.all %}
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="{{ subcategory.slug }}-tab" data-bs-toggle="pill" data-bs-target="#{{ subcategory.slug }}" type="button" role="tab" aria-controls="{{ subcategory.slug }}" aria-selected="false">{{ subcategory.name_ar }}</button>
                </li>
                {% empty %}
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="dresses-tab" data-bs-toggle="pill" data-bs-target="#dresses" type="button" role="tab" aria-controls="dresses" aria-selected="false">فساتين</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="blouses-tab" data-bs-toggle="pill" data-bs-target="#blouses" type="button" role="tab" aria-controls="blouses" aria-selected="false">بلوزات</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="pants-tab" data-bs-toggle="pill" data-bs-target="#pants" type="button" role="tab" aria-controls="pants" aria-selected="false">بناطيل</button>
                </li>
                <li class="nav-item" role="presentation">
                  <button class="nav-link" id="bags-tab" data-bs-toggle="pill" data-bs-target="#bags" type="button" role="tab" aria-controls="bags" aria-selected="false">حقائب</button>
                </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- Products Grid -->
      <section class="products-section py-5">
        <div class="container">
          <!-- Filter Options -->
          <div class="filter-options mb-4">
            <div class="row align-items-center">
              <div class="col-md-6">
                <div class="showing-results">
                  <span>عرض {{ page_obj.start_index }} - {{ page_obj.end_index }} من {{ page_obj.paginator.count }} منتج</span>
                </div>
              </div>
              <div class="col-md-6">
                <div class="d-flex justify-content-md-end">
                  <div class="dropdown sort-dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="sortDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                      ترتيب حسب
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="sortDropdown">
                      <li><a class="dropdown-item {% if sort_by == 'newest' %}active{% endif %}" href="?sort=newest">الأحدث</a></li>
                      <li><a class="dropdown-item {% if sort_by == 'price_low' %}active{% endif %}" href="?sort=price_low">السعر: من الأقل للأعلى</a></li>
                      <li><a class="dropdown-item {% if sort_by == 'price_high' %}active{% endif %}" href="?sort=price_high">السعر: من الأعلى للأقل</a></li>
                      <li><a class="dropdown-item {% if sort_by == 'popular' %}active{% endif %}" href="?sort=popular">الأكثر مبيعاً</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Products Grid -->
          <div class="tab-content" id="categoryTabsContent">
            <div class="tab-pane fade show active" id="all" role="tabpanel" aria-labelledby="all-tab">
              <div class="row g-4" id="productsGrid">
                {% for product in products %}
                <div class="col-6 col-md-4 col-lg-3">
                  <div class="product-card" data-description="{{ product.description_ar }}">
                    {% if product.badge or product.is_new or product.is_on_sale %}
                      <div class="product-badge">
                        {% if product.badge %}
                          {{ product.get_badge_display }}
                        {% elif product.is_new %}
                          جديد
                        {% elif product.is_on_sale %}
                          خصم {{ product.get_discount_percentage }}%
                        {% endif %}
                      </div>
                    {% endif %}
                    <div class="product-img-container">
                      <img src="{% get_product_image_url product %}" alt="{{ product.name_ar }}" class="product-img">
                      <div class="product-actions">
                        <button class="action-btn quick-view-btn">
                          <i class="bi bi-eye"></i>
                        </button>
                        <button class="action-btn">
                          <i class="bi bi-heart"></i>
                        </button>
                        <button class="action-btn">
                          <i class="bi bi-bag-plus"></i>
                        </button>
                      </div>
                    </div>
                    <div class="product-info">
                      <div class="product-category">{{ product.category.name_ar }}</div>
                      <h3 class="product-title">
                        <a href="{{ product.get_absolute_url }}" class="product-link">{{ product.name_ar }}</a>
                      </h3>
                      <div class="product-price">
                        <span class="current-price">{{ product.price }} ج.م</span>
                        {% if product.old_price %}
                          <span class="old-price">{{ product.old_price }} ج.م</span>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
                {% empty %}
                <div class="col-12 text-center py-5">
                  <p>لا توجد منتجات متاحة حالياً</p>
                </div>
                {% endfor %}
              </div>
            </div>
            
            {% for subcategory in category.children.all %}
            <div class="tab-pane fade" id="{{ subcategory.slug }}" role="tabpanel" aria-labelledby="{{ subcategory.slug }}-tab">
              <div class="row g-4">
                {% for product in products %}
                  {% if product.category == subcategory %}
                    <div class="col-6 col-md-4 col-lg-3">
                      <div class="product-card" data-description="{{ product.description_ar }}">
                        {% if product.badge or product.is_new or product.is_on_sale %}
                          <div class="product-badge">
                            {% if product.badge %}
                              {{ product.get_badge_display }}
                            {% elif product.is_new %}
                              جديد
                            {% elif product.is_on_sale %}
                              خصم {{ product.get_discount_percentage }}%
                            {% endif %}
                          </div>
                        {% endif %}
                        <div class="product-img-container">
                          <img src="{% get_product_image_url product %}" alt="{{ product.name_ar }}" class="product-img">
                          <div class="product-actions">
                            <button class="action-btn quick-view-btn">
                              <i class="bi bi-eye"></i>
                            </button>
                            <button class="action-btn">
                              <i class="bi bi-heart"></i>
                            </button>
                            <button class="action-btn">
                              <i class="bi bi-bag-plus"></i>
                            </button>
                          </div>
                        </div>
                        <div class="product-info">
                          <div class="product-category">{{ product.category.name_ar }}</div>
                          <h3 class="product-title">
                            <a href="{{ product.get_absolute_url }}" class="product-link">{{ product.name_ar }}</a>
                          </h3>
                          <div class="product-price">
                            <span class="current-price">{{ product.price }} ج.م</span>
                            {% if product.old_price %}
                              <span class="old-price">{{ product.old_price }} ج.م</span>
                            {% endif %}
                          </div>
                        </div>
                      </div>
                    </div>
                  {% endif %}
                {% empty %}
                  <div class="col-12 text-center py-5">
                    <p>لا توجد منتجات متاحة حالياً</p>
                  </div>
                {% endfor %}
              </div>
            </div>
            {% endfor %}
          </div>

          <!-- Pagination -->
          {% if page_obj.has_other_pages %}
          <div class="pagination-section mt-5">
            <nav aria-label="Page navigation">
              <ul class="pagination justify-content-center">
                {% if page_obj.has_previous %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if sort_by %}&sort={{ sort_by }}{% endif %}" aria-label="Previous">
                    <span aria-hidden="true">السابق</span>
                  </a>
                </li>
                {% else %}
                <li class="page-item disabled">
                  <a class="page-link" href="#" tabindex="-1" aria-disabled="true">السابق</a>
                </li>
                {% endif %}
                
                {% for i in page_obj.paginator.page_range %}
                  {% if page_obj.number == i %}
                    <li class="page-item active"><a class="page-link" href="#">{{ i }}</a></li>
                  {% elif i > page_obj.number|add:'-3' and i < page_obj.number|add:'3' %}
                    <li class="page-item"><a class="page-link" href="?page={{ i }}{% if sort_by %}&sort={{ sort_by }}{% endif %}">{{ i }}</a></li>
                  {% endif %}
                {% endfor %}
                
                {% if page_obj.has_next %}
                <li class="page-item">
                  <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if sort_by %}&sort={{ sort_by }}{% endif %}" aria-label="Next">
                    <span aria-hidden="true">التالي</span>
                  </a>
                </li>
                {% else %}
                <li class="page-item disabled">
                  <a class="page-link" href="#" tabindex="-1" aria-disabled="true">التالي</a>
                </li>
                {% endif %}
              </ul>
            </nav>
          </div>
          {% endif %}
        </div>
      </section>

      <!-- Featured Collections -->
      <section class="featured-collections py-5 bg-light" id="collections">
        <div class="container">
          <div class="row g-4">
            {% for collection in active_collections|slice:":2" %}
            <div class="col-md-6">
              <div class="collection-card">
                <img src="{{ collection.image.url }}" alt="{{ collection.name_ar }}" class="img-fluid">
                <div class="collection-overlay">
                  <div class="collection-content">
                    <h3 class="collection-title">{{ collection.name_ar }}</h3>
                    <p class="collection-desc">{{ collection.description_ar }}</p>
                    <a href="{% url 'product:collection_detail' collection.slug %}" class="btn btn-outline-light">تسوقي الآن</a>
                  </div>
                </div>
              </div>
            </div>
            {% empty %}
            <div class="col-md-6">
              <div class="collection-card">
                <img src="https://images.pexels.com/photos/7679720/pexels-photo-7679720.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="مجموعة الفساتين" class="img-fluid">
                <div class="collection-overlay">
                  <div class="collection-content">
                    <h3 class="collection-title">الفساتين الأنيقة</h3>
                    <p class="collection-desc">تشكيلة متنوعة من الفساتين العصرية المصنوعة من أجود أنواع الأقمشة</p>
                    <a href="#" class="btn btn-outline-light">تسوق الآن</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="collection-card">
                <img src="https://images.pexels.com/photos/6567607/pexels-photo-6567607.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="مجموعة الإكسسوارات" class="img-fluid">
                <div class="collection-overlay">
                  <div class="collection-content">
                    <h3 class="collection-title">الإكسسوارات العصرية</h3>
                    <p class="collection-desc">حقائب وإكسسوارات مميزة تكمل إطلالتك بأناقة</p>
                    <a href="#" class="btn btn-outline-light">تسوق الآن</a>
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </section>

      <!-- Style Guide -->
      <section class="style-guide py-5">
        <div class="container">
          <div class="section-header text-center mb-5">
            <h2 class="section-title">دليل الأناقة</h2>
            <div class="decorative-line"></div>
          </div>
          <div class="row g-4">
            <div class="col-md-4">
              <div class="style-card text-center">
                <div class="style-icon mb-3">
                  <i class="bi bi-rulers"></i>
                </div>
                <h4 class="style-title">دليل المقاسات</h4>
                <p class="style-text">تعرفي على المقاس المناسب لك من خلال دليل المقاسات التفصيلي</p>
                <a href="#" class="btn btn-link">اكتشفي المزيد</a>
              </div>
            </div>
            <div class="col-md-4">
              <div class="style-card text-center">
                <div class="style-icon mb-3">
                  <i class="bi bi-palette"></i>
                </div>
                <h4 class="style-title">تنسيق الألوان</h4>
                <p class="style-text">نصائح لتنسيق الألوان واختيار الإطلالة المثالية</p>
                <a href="#" class="btn btn-link">اكتشفي المزيد</a>
              </div>
            </div>
            <div class="col-md-4">
              <div class="style-card text-center">
                <div class="style-icon mb-3">
                  <i class="bi bi-stars"></i>
                </div>
                <h4 class="style-title">آخر الصيحات</h4>
                <p class="style-text">تعرفي على أحدث صيحات الموضة وأبرز التصاميم العصرية</p>
                <a href="#" class="btn btn-link">اكتشفي المزيد</a>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Quick View Modal -->
      <div class="modal fade" id="quickViewModal" tabindex="-1" aria-labelledby="quickViewModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="quickViewModalLabel">عرض سريع</h5>
              <button type="button" class="btn-close ms-0 me-auto" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col-md-6 mb-4 mb-md-0">
                  <img id="modalProductImage" src="" alt="Product" class="img-fluid rounded">
                </div>
                <div class="col-md-6">
                  <h4 id="modalProductName" class="mb-3"></h4>
                  <div class="product-price mb-3">
                    <span id="modalProductPrice" class="current-price"></span>
                    <span id="modalProductOldPrice" class="old-price"></span>
                  </div>
                  <div class="product-rating mb-3">
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-fill"></i>
                    <i class="bi bi-star-half"></i>
                    <span class="rating-count">(24)</span>
                  </div>
                  <p id="modalProductDescription" class="mb-4"></p>
                  <div class="product-size mb-4">
                    <h6>المقاس:</h6>
                    <div class="size-options">
                      <button class="size-btn">S</button>
                      <button class="size-btn active">M</button>
                      <button class="size-btn">L</button>
                      <button class="size-btn">XL</button>
                    </div>
                  </div>
                  <div class="product-color mb-4">
                    <h6>اللون:</h6>
                    <div class="color-options">
                      <button class="color-btn" style="background-color: #000;"></button>
                      <button class="color-btn active" style="background-color: #5F4B32;"></button>
                      <button class="color-btn" style="background-color: #1A3263;"></button>
                    </div>
                  </div>
                  <div class="product-quantity mb-4">
                    <h6>الكمية:</h6>
                    <div class="quantity-selector">
                      <button class="quantity-btn" id="decreaseQuantity">-</button>
                      <input type="number" class="quantity-input" value="1" min="1" max="10">
                      <button class="quantity-btn" id="increaseQuantity">+</button>
                    </div>
                  </div>
                  <div class="product-actions">
                    <button class="btn btn-primary w-100 mb-2">أضف إلى السلة</button>
                    <button class="btn btn-outline-secondary w-100">أضف إلى المفضلة</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endblock content %}


